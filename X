--[[
    XeroLib v2.8 - Smart Icon System
    Author: Bytox
    Features:
    - Load icons from Pastefy URL
    - Access by name (loaded from Pastefy)
    - Direct rbxassetid:// support
    - Built-in fallback icons
]]

local XeroLib = {}
XeroLib.__index = XeroLib
XeroLib.Version = "2.8.0"

-- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –∏–∫–æ–Ω–∫–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã
XeroLib.FallbackIcons = {
    ["fallback"] = "rbxassetid://7733919881", -- circle
    ["home"] = "rbxassetid://7733914390", -- book
    ["settings"] = "rbxassetid://7733911828", -- bell
    ["run"] = "rbxassetid://7733678330", -- bike
    ["stop"] = "rbxassetid://7733674153", -- banknote
    ["check"] = "rbxassetid://7733715400",
    ["error"] = "rbxassetid://7733658335",
}

-- –û—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ (–Ω–∞—á–∏–Ω–∞–µ–º —Å —Ñ–æ–ª–±—ç–∫–æ–≤)
XeroLib.Icons = XeroLib.FallbackIcons

-- –ó–ê–ì–†–£–ó–ö–ê –ò–ö–û–ù–û–ö –° PASTEFY
function XeroLib:LoadIcons()
    local pastefyURL = "https://pastefy.app/GJsDsU1d/raw"
    
    local success, result = pcall(function()
        local iconCode = game:HttpGet(pastefyURL, true)
        local iconLoader = loadstring(iconCode)
        if not iconLoader then return nil end
        
        local iconData = iconLoader()
        
        -- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤
        if type(iconData) == "table" then
            if iconData.Data then
                return iconData.Data
            elseif iconData.Get then
                return iconData.Get()
            else
                return iconData
            end
        end
        
        return nil
    end)
    
    if success and result then
        -- –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –∏–∫–æ–Ω–∫–∏
        local count = 0
        for name, assetId in pairs(result) do
            XeroLib.Icons[name] = assetId
            count = count + 1
        end
        print(string.format("XeroLib: Loaded %d icons from Pastefy", count))
        return true
    else
        warn("XeroLib: Using fallback icons only")
        return false
    end
end

-- –£–ú–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –ü–û–õ–£–ß–ï–ù–ò–Ø –ò–ö–û–ù–ö–ò
function XeroLib:GetIcon(iconSource)
    -- –ï—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω rbxassetid –Ω–∞–ø—Ä—è–º—É—é - –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–∞–∫ –µ—Å—Ç—å
    if type(iconSource) == "string" and iconSource:find("^rbxassetid://") then
        return iconSource
    end
    
    -- –ï—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω –Ω–æ–º–µ—Ä (id)
    if type(iconSource) == "number" then
        return "rbxassetid://" .. tostring(iconSource)
    end
    
    -- –ï—Å–ª–∏ —ç—Ç–æ —Å—Ç—Ä–æ–∫–∞, –ø—Ä–æ–≤–µ—Ä—è–µ–º –≤ —Ç–∞–±–ª–∏—Ü–µ –∏–∫–æ–Ω–æ–∫
    if type(iconSource) == "string" then
        local icon = XeroLib.Icons[iconSource]
        if icon then
            return icon
        else
            -- –ï—Å–ª–∏ –Ω–µ—Ç –≤ —Ç–∞–±–ª–∏—Ü–µ, –Ω–æ –ø–æ—Ö–æ–∂–µ –Ω–∞ ID
            if iconSource:match("^%d+$") then
                return "rbxassetid://" .. iconSource
            end
            return nil -- –Ω–µ –Ω–∞—à–ª–∏
        end
    end
    
    return nil
end

-- –ü–†–û–í–ï–†–ö–ê: —ç—Ç–æ rbxassetid –∏–ª–∏ –∏–º—è –∏–∫–æ–Ω–∫–∏?
function XeroLib:IsRbxAssetId(source)
    return type(source) == "string" and source:find("^rbxassetid://")
end

-- –î–û–ë–ê–í–õ–ï–ù–ò–ï –°–í–û–ï–ô –ò–ö–û–ù–ö–ò –í –ë–ò–ë–õ–ò–û–¢–ï–ö–£
function XeroLib:AddIcon(name, assetId)
    if name and assetId then
        XeroLib.Icons[name] = assetId
        return true
    end
    return false
end

-- NOTIFICATION TYPES
XeroLib.NotifyType = {
    INFO = { Color = Color3.fromRGB(0, 120, 215), Icon = "üìò" },
    SUCCESS = { Color = Color3.fromRGB(0, 200, 83), Icon = "‚úÖ" },
    WARNING = { Color = Color3.fromRGB(255, 185, 0), Icon = "‚ö†Ô∏è" },
    ERROR = { Color = Color3.fromRGB(255, 60, 60), Icon = "‚ùå" }
}

-- –¢–ï–ú–´ (—É–ø—Ä–æ—â–µ–Ω–Ω—ã–µ)
XeroLib.Themes = {
    Dark = {
        Background = Color3.fromRGB(18, 18, 18),
        Foreground = Color3.fromRGB(28, 28, 28),
        Text = Color3.fromRGB(240, 240, 240),
        Button = Color3.fromRGB(38, 38, 38),
        ButtonHover = Color3.fromRGB(48, 48, 48),
        ToggleOn = Color3.fromRGB(0, 180, 0),
        ToggleOff = Color3.fromRGB(70, 20, 20),
        TabActive = Color3.fromRGB(40, 40, 40),
    }
}
XeroLib.CurrentTheme = XeroLib.Themes.Dark

-- Services
local Players = game:GetService("Players")

-- Utility
local function Create(class, props)
    local obj = Instance.new(class)
    for k, v in pairs(props or {}) do
        if k ~= "Parent" then
            obj[k] = v
        end
    end
    if props and props.Parent then
        obj.Parent = props.Parent
    end
    return obj
end

local function ApplyCorners(obj, radius)
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, radius)
    corner.Parent = obj
    return corner
end

-- –ì–õ–ê–í–ù–û–ï –û–ö–ù–û
function XeroLib:New(title, loadPastefyIcons)
    local selfObj = setmetatable({}, XeroLib)
    
    -- –ê–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞ –∏–∫–æ–Ω–æ–∫ —Å Pastefy
    if loadPastefyIcons ~= false then
        selfObj:LoadIcons()
    end
    
    selfObj.ScreenGui = Create("ScreenGui", {
        Parent = game:GetService("CoreGui"),
        Name = "XeroLib",
        ResetOnSpawn = false
    })
    
    selfObj.MainFrame = Create("Frame", {
        Parent = selfObj.ScreenGui,
        Size = UDim2.new(0, 500, 0, 350),
        Position = UDim2.new(0.5, -250, 0.5, -175),
        BackgroundColor3 = selfObj.CurrentTheme.Background,
        BorderSizePixel = 0,
        Active = true,
        Draggable = true
    })
    
    ApplyCorners(selfObj.MainFrame, 8)
    
    -- Title
    Create("TextLabel", {
        Parent = selfObj.MainFrame,
        Size = UDim2.new(1, 0, 0, 40),
        Text = title or "Xero Hub",
        TextColor3 = selfObj.CurrentTheme.Text,
        Font = Enum.Font.GothamBold,
        TextSize = 18,
        BackgroundColor3 = selfObj.CurrentTheme.Foreground,
        BorderSizePixel = 0
    })
    
    ApplyCorners(selfObj.MainFrame:FindFirstChildOfClass("TextLabel"), 8)
    
    -- Tab area
    selfObj.TabList = Create("ScrollingFrame", {
        Parent = selfObj.MainFrame,
        Size = UDim2.new(0, 120, 1, -40),
        Position = UDim2.new(0, 0, 0, 40),
        BackgroundColor3 = selfObj.CurrentTheme.Background,
        BorderSizePixel = 0,
        ScrollBarThickness = 4
    })
    
    -- Content area
    selfObj.Content = Create("Frame", {
        Parent = selfObj.MainFrame,
        Position = UDim2.new(0, 120, 0, 40),
        Size = UDim2.new(1, -120, 1, -40),
        BackgroundColor3 = selfObj.CurrentTheme.Background,
        BorderSizePixel = 0
    })
    
    selfObj.Tabs = {}
    selfObj.TabButtons = {}
    
    return selfObj
end

-- –í–ö–õ–ê–î–ö–ê –° –£–ú–ù–û–ô –ò–ö–û–ù–ö–û–ô
function XeroLib:AddTab(name, iconSource)
    -- –£–º–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–∫–æ–Ω–∫–∏
    local icon = self:GetIcon(iconSource)
    
    local button = Create("TextButton", {
        Parent = self.TabList,
        Size = UDim2.new(1, -10, 0, 35),
        Position = UDim2.new(0, 5, 0, (#self.TabButtons * 40) + 5),
        Text = name,
        TextColor3 = self.CurrentTheme.Text,
        Font = Enum.Font.GothamBold,
        TextSize = 14,
        BackgroundColor3 = self.CurrentTheme.Foreground,
        BorderSizePixel = 0,
        AutoButtonColor = false
    })
    
    ApplyCorners(button, 6)
    
    -- –ï—Å–ª–∏ –µ—Å—Ç—å –∏–∫–æ–Ω–∫–∞, –¥–æ–±–∞–≤–ª—è–µ–º –µ—ë
    if icon then
        local iconImage = Create("ImageLabel", {
            Parent = button,
            Size = UDim2.new(0, 20, 0, 20),
            Position = UDim2.new(0, 8, 0.5, -10),
            Image = icon,
            BackgroundTransparency = 1,
            ImageColor3 = self.CurrentTheme.Text
        })
        
        button.TextXAlignment = Enum.TextXAlignment.Left
        button.PaddingLeft = UDim.new(0, 30)
    end
    
    -- –ö–æ–Ω—Ç–µ–Ω—Ç –≤–∫–ª–∞–¥–∫–∏
    local tabContent = Create("ScrollingFrame", {
        Parent = self.Content,
        Size = UDim2.new(1, 0, 1, 0),
        BackgroundTransparency = 1,
        ScrollBarThickness = 8,
        Visible = #self.Tabs == 0
    })
    
    self.Tabs[name] = tabContent
    self.TabButtons[name] = button
    
    -- –ö–ª–∏–∫ –ø–æ –≤–∫–ª–∞–¥–∫–µ
    button.MouseButton1Click:Connect(function()
        for _, content in pairs(self.Tabs) do
            content.Visible = false
        end
        tabContent.Visible = true
        
        for _, btn in pairs(self.TabButtons) do
            btn.BackgroundColor3 = self.CurrentTheme.Foreground
        end
        button.BackgroundColor3 = self.CurrentTheme.TabActive
    end)
    
    if #self.Tabs == 1 then
        button.BackgroundColor3 = self.CurrentTheme.TabActive
    end
    
    return tabContent
end

-- –ö–ù–û–ü–ö–ê –° –£–ú–ù–û–ô –ò–ö–û–ù–ö–û–ô
function XeroLib:AddButton(tab, text, callback, iconSource)
    -- –£–º–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–∫–æ–Ω–∫–∏
    local icon = self:GetIcon(iconSource)
    
    local button = Create("TextButton", {
        Parent = tab,
        Size = UDim2.new(1, 0, 0, 35),
        Text = text,
        TextColor3 = self.CurrentTheme.Text,
        Font = Enum.Font.GothamBold,
        TextSize = 14,
        BackgroundColor3 = self.CurrentTheme.Button,
        BorderSizePixel = 0,
        AutoButtonColor = false
    })
    
    ApplyCorners(button, 6)
    
    -- –ï—Å–ª–∏ –µ—Å—Ç—å –∏–∫–æ–Ω–∫–∞, –¥–æ–±–∞–≤–ª—è–µ–º –µ—ë
    if icon then
        local iconImage = Create("ImageLabel", {
            Parent = button,
            Size = UDim2.new(0, 20, 0, 20),
            Position = UDim2.new(0, 10, 0.5, -10),
            Image = icon,
            BackgroundTransparency = 1,
            ImageColor3 = self.CurrentTheme.Text
        })
        
        button.TextXAlignment = Enum.TextXAlignment.Left
        button.PaddingLeft = UDim.new(0, 35)
    end
    
    button.MouseButton1Click:Connect(function()
        if callback then callback() end
    end)
    
    return button
end

-- –ü–†–ò–ú–ï–†–´ –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø
function XeroLib:ShowExamples()
    local ui = self:New("XeroLib Demo", true) -- –ó–∞–≥—Ä—É–∂–∞–µ–º –∏–∫–æ–Ω–∫–∏ —Å Pastefy
    
    -- –ü—Ä–∏–º–µ—Ä 1: –ò–∫–æ–Ω–∫–∏ –∏–∑ Pastefy –ø–æ –∏–º–µ–Ω–∏
    local tab1 = ui:AddTab("Pastefy Icons", "home")
    
    ui:AddButton(tab1, "Run Script", function()
        print("Running script")
    end, "run") -- –∏–∫–æ–Ω–∫–∞ "run" –∏–∑ Pastefy
    
    -- –ü—Ä–∏–º–µ—Ä 2: –ü—Ä—è–º–æ–π rbxassetid
    local tab2 = ui:AddTab("Custom Icons", "rbxassetid://10709781460")
    
    ui:AddButton(tab2, "Custom Image", function()
        print("Custom button clicked")
    end, "rbxassetid://7733678330") -- –ø—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞
    
    -- –ü—Ä–∏–º–µ—Ä 3: –ü—Ä–æ—Å—Ç–æ ID –∫–∞–∫ —á–∏—Å–ª–æ
    local tab3 = ui:AddTab("By ID", 7733914390) -- —á–∏—Å–ª–æ = ID
    
    ui:AddButton(tab3, "Test", function()
        print("Test")
    end, 7733674153) -- —á–∏—Å–ª–æ = ID
    
    return ui
end

return XeroLib